<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
</head>
<template id="proto-editor-template">
	<pre id="editor" contenteditable="false"></pre>
</template>
<script>
	{
	    const { ownerDocument } = document.currentScript
		class ProtoEditor extends HTMLElement {
			constructor() {
				super()

				const { content } = ownerDocument.getElementById("proto-editor-template")
				const orphan = document.importNode(content, true)

				this.root = this.attachShadow({mode: "open"})
				this.root.appendChild(orphan)

				this.editor = this.root.getElementById("editor")
				this.editor.addEventListener("input", event => this.dispatchEvent(new Event("input")))
			}
			static get observedAttributes() {
				return ["locked"]
			}
			attributeChangedCallback() {
				this.editor.contentEditable = !JSON.parse(this.getAttribute("locked"))
			}
			connectedCallback() {
			    this.attributeChangedCallback()
			}
			focusContent() {
			    this.editor.focus()
			}
			get content() {
			    return this.editor.innerHTML
			}
			set content(content) {
				this.editor.innerHTML = content
			}
		}
		customElements.define("proto-editor", ProtoEditor)
	}

</script>

</html>